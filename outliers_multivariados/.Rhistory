summary(mod)$coefficients[p.vals < 0.25]
rownames(summary(mod)$coefficients)[p.vals < 0.25]
# quais abaixo de P=0.25
nomes <- rownames(summary(mod)$coefficients)[p.vals < 0.25]
var.fora <- substr(nomes,9,11)
var.fora
var.fora <- substr(nomes,9,-1)
var.fora
var.fora <- substr(nomes,9,-12)
var.fora
nvar(nomes)
nchar(nomes)
var.fora <- substr(nomes,9,nchar(nomes)-1)
var.fora
#removendo
update(mod, .~. -nomes )
#removendo
update(mod, .~. - eval(nomes ))
i=1
var <- paste0(nomes[i])
var
varis <- paste0(var, "+", nomes[i])
varis
i=2
varis <- paste(var, "+", nomes[i])
varis
var <- varis
var <- paste0(nomes[1])
for(i in 2:length(nomes)){
varis <- paste(var, "+", nomes[i])
var <- varis
}
var
#removendo
nomes.fica <- rownames(summary(mod)$coefficients)[p.vals >= 0.25]
var <- paste0(nomes.fica[1])
for(i in 2:length(nomes.fica)){
varis <- paste(var, "+", nomes[i])
var <- varis
}
var
rm(var)
var <- paste0(nomes.fica[1])
var
for(i in 2:length(nomes.fica)){
varis <- paste(var, "+", nomes.fica[i])
var <- varis
}
var
lm(matriz[,51]~unquote(var))
lm(matriz[,51]~noquote(var))
noquote(var)
paste("lm(matriz[,51] ~ ",var)
eval(paste("lm(matriz[,51] ~ ",var))
eval(noquote(paste("lm(matriz[,51] ~ ",var)))
eval(noquote(paste("lm(matriz[,51] ~ ",var, ")")))
eval(paste("lm(matriz[,51] ~ ",var, ")"))
eval(parse(text = paste("lm(matriz[,51] ~ ",var, ")")))
rm(var)
var <- paste0(nomes.fica[2])
for(i in 3:length(nomes.fica)){
varis <- paste(var, "+", nomes.fica[i])
var <- varis
}
eval(parse(text = paste("lm(matriz[,51] ~ ",var, ")")))
summary(mod2)
mod2 <- eval(parse(text = paste("lm(matriz[,51] ~ ",var, ")")))
summary(mod2)
summary(mod2)
glance(mod2)
glance(mod2)["r.squared"]
glance(mod2)["adj.r.squared"]
glance(mod2)["p.value"]
#quantos coeficientes significativos <0.05
p.vals <- summary(mod2)$coefficients[,4]
sum(p.vals < 0.05)
#quantos abaixo de p=0.25
sum(p.vals < 0.25)
# quais abaixo de P=0.25
nomes <- rownames(summary(mod2)$coefficients)[p.vals < 0.25]
#removendo
nomes.fica <- rownames(summary(mod2)$coefficients)[p.vals >= 0.25]
nomes.fica
var <- paste0(nomes.fica[2])
var
for(i in 3:length(nomes.fica)){
varis <- paste(var, "+", nomes.fica[i])
var <- varis
}
var
nomes
## novo modelo
mod3 <- eval(parse(text = paste("lm(matriz[,51] ~ ",var, ")")))
summary(mod3)
glance(mod2)
glance(mod3)
glance(mod2)["r.squared"]
glance(mod2)["adj.r.squared"]
glance(mod2)["p.value"]
# quais abaixo de P=0.25
nomes <- rownames(summary(mod2)$coefficients)[p.vals < 0.25]
#removendo as variáveis não significativas
var <- paste0(nomes[2])
for(i in 3:length(nomes)){
varis <- paste(var, "+", nomes[i])
var <- varis
}
set.seed(33)
matriz <- matrix(rnorm(100*51,0,1), nrow=100, ncol=51)
mod <- lm(matriz[,51]~matriz[,1]+matriz[,2]+matriz[,3]+matriz[,4]+matriz[,5]+
matriz[,6]+matriz[,7]+matriz[,8]+matriz[,9]+matriz[,10]+
matriz[,11]+matriz[,12]+matriz[,13]+matriz[,14]+matriz[,15]+
matriz[,16]+matriz[,17]+matriz[,18]+matriz[,19]+matriz[,20]+
matriz[,21]+matriz[,22]+matriz[,23]+matriz[,24]+matriz[,25]+
matriz[,26]+matriz[,27]+matriz[,28]+matriz[,29]+matriz[,30]+
matriz[,31]+matriz[,32]+matriz[,33]+matriz[,34]+matriz[,35]+
matriz[,36]+matriz[,37]+matriz[,38]+matriz[,39]+matriz[,40]+
matriz[,41]+matriz[,42]+matriz[,43]+matriz[,44]+matriz[,45]+
matriz[,46]+matriz[,47]+matriz[,48]+matriz[,49]+matriz[,50])
summary(mod)
glance(mod)
glance(mod)["r.squared"]
glance(mod)["adj.r.squared"]
glance(mod)["p.value"]
#quantos coeficientes significativos <0.05
p.vals <- summary(mod)$coefficients[,4]
sum(p.vals < 0.05)
#quantos abaixo de p=0.25
sum(p.vals < 0.25)
# quais abaixo de P=0.25
nomes <- rownames(summary(mod)$coefficients)[p.vals < 0.25]
nomes
# quais abaixo de P=0.25
nomes <- rownames(summary(mod)$coefficients)[p.vals =< 0.25]
# quais abaixo de P=0.25
nomes <- rownames(summary(mod)$coefficients)[p.vals <= 0.25]
nomes
#quantos abaixo de p=0.25
sum(p.vals <= 0.25)
var <- paste0(nomes[2])
for(i in 3:length(nomes)){
varis <- paste(var, "+", nomes[i])
var <- varis
}
## novo modelo
mod2 <- eval(parse(text = paste("lm(matriz[,51] ~ ",var, ")")))
summary(mod2)
glance(mod2)
#quantos coeficientes significativos <0.05
p.vals <- summary(mod2)$coefficients[,4]
sum(p.vals < 0.05)
#quantos abaixo de p=0.25
sum(p.vals <= 0.25)
# quais abaixo de P=0.25
nomes <- rownames(summary(mod2)$coefficients)[p.vals <= 0.25]
#removendo as variáveis não significativas
var <- paste0(nomes[2])
for(i in 3:length(nomes)){
varis <- paste(var, "+", nomes[i])
var <- varis
}
## novo modelo
mod3 <- eval(parse(text = paste("lm(matriz[,51] ~ ",var, ")")))
summary(mod3)
#quantos coeficientes significativos <0.05
p.vals <- summary(mod3)$coefficients[,4]
sum(p.vals < 0.05)
#quantos abaixo de p=0.25
sum(p.vals <= 0.25)
# quais abaixo de P=0.25
nomes <- rownames(summary(mod3)$coefficients)[p.vals <= 0.25]
nomes
#removendo as variáveis não significativas
var <- paste0(nomes[2])
for(i in 3:length(nomes)){
varis <- paste(var, "+", nomes[i])
var <- varis
}
## novo modelo
mod4 <- eval(parse(text = paste("lm(matriz[,51] ~ ",var, ")")))
summary(mod4)
setwd("~/Documents/GitHub/roteiros_blog/premissas_multivariada")
#install_github("melina-leite/rmdformats")
library(knitr)
library(skimr)
library(ggplot2)
library(tidyverse)
opts_chunk$set(
fig.align = "center", fig.show = "hold", fig.height = 4,
warning = F, message = F, error = F, cache = T
)
options(formatR.arrow = TRUE, width = 90)
plot(swiss[,1:2])
help("datasets")
help(help="datasets")
library(help="datasets")
headairquality)
head(airquality)
dim(ariquality)
dim(airquality)
plot(airquality[,3:4])
plot(airquality[,2:4])
plot(iris)
plot(women)
women
plot(trees)
plot(swiss[,1:3])
plot(swiss)
plot(swiss[,3:4])
plot(swiss[,3:4])
maha <- mahalanobis(swiss[,3:4])
library(vegan)
maha <- vegdist(swiss[,3:4], "mahalanobis")
maha
maha <- mahalanobis(swiss[,3:4], center = colMeans(swiss[,3:4]), cov = cov(swiss[,3:4]))
maha1 <- vegdist(swiss[,3:4], "mahalanobis")
maha2 <- mahalanobis(swiss[,3:4], center = colMeans(swiss[,3:4]), cov = cov(swiss[,3:4]))
maha2
maha1
maha1
maha1
maha1
maha2 <- mahalanobis(swiss[,3:4], center = colMeans(swiss[,3:4]), cov = cov(swiss[,3:4]))
plot(maha2)
x <- matrix(rnorm(100*3), ncol = 3)
Sx <- cov(x)
D2 <- mahalanobis(x, colMeans(x), Sx)
plot(density(D2, bw = 0.5),
main="Squared Mahalanobis distances, n=100, p=3") ; rug(D2)
plot(D2)
qqplot(qchisq(ppoints(100), df = 3), D2,
main = expression("Q-Q plot of Mahalanobis" * ~D^2 *
" vs. quantiles of" * ~ chi[3]^2))
abline(0, 1, col = 'gray')
qqplot(qchisq(ppoints(100), df = 3), D2,
main = expression("Q-Q plot of Mahalanobis" * ~D^2 *
" vs. quantiles of" * ~ chi[3]^2))
abline(0, 1, col = 'gray')
qchisq(D2)
qchisq(D2, df=2)
qchisq(0.05, df=2)
pchisq(D2, df=2)
D2
D2 <- mahalanobis(x, colMeans(x), Sx)
pchisq(maha2, df=2)
qchisq(0.05, 2)
maha2
qchisq(0.05, 2. lower.tail = F)
qchisq(0.05, 2, lower.tail = F)
plot(maha2)
plot(maha2)
abline(h=qchisq(0.05, 2, lower.tail = F))
abline(h=qchisq(0.05, 2, lower.tail = F), lty=2)
plot(maha2)
abline(h=qchisq(0.05, 2, lower.tail = F), lty=2)
out <- maha2[maha2<=qchisq(0.05, 2, lower.tail = F)]
out
out <- maha2[maha2>qchisq(0.05, 2, lower.tail = F)]
out
text(maha2[out], names(maha2[out]))
maha2[out]
plot(maha2)
abline(h=qchisq(0.05, 2, lower.tail = F), lty=2)
out <- maha2[maha2>qchisq(0.05, 2, lower.tail = F)]
text(maha2[out], names(maha2[out]))
(maha2[out]
maha2[out]
text(out, names(out))
plot(maha2)
abline(h=qchisq(0.05, 2, lower.tail = F), lty=2)
out <- maha2[maha2>qchisq(0.05, 2, lower.tail = F)]
text(out, names(out))
text(rownames(maha2[out]),out, names(out))
plot(maha2)
abline(h=qchisq(0.05, 2, lower.tail = F), lty=2)
out <- maha2[maha2>qchisq(0.05, 2, lower.tail = F)]
text(rownames(maha2[out]),out, names(out))
(maha2[out]
rownames(maha2[out])
names(out)
maha2[names(out)]
rownames(maha2[names(out)])
plot(maha2)
abline(h=qchisq(0.05, 2, lower.tail = F), lty=2)
out <- maha2[maha2>qchisq(0.05, 2, lower.tail = F)]
text(maha2[names(out)],out, names(out))
text(maha2[maha2>qchisq(0.05, 2, lower.tail = F)],out, names(out))
plot(maha2)
abline(h=qchisq(0.05, 2, lower.tail = F), lty=2)
out <- maha2[maha2>qchisq(0.05, 2, lower.tail = F)]
text(maha2[maha2>qchisq(0.05, 2, lower.tail = F)],out, names(out))
plot(1:length(maha2), maha2)
plot(1:length(maha2), maha2)
abline(h=qchisq(0.05, 2, lower.tail = F), lty=2)
out <- maha2[maha2>qchisq(0.05, 2, lower.tail = F)]
text(maha2[maha2>qchisq(0.05, 2, lower.tail = F)],out, names(out))
maha2[maha2>qchisq(0.05, 2, lower.tail = F)]
text(order(maha2[maha2>qchisq(0.05, 2, lower.tail = F)]), out, names(out))
plot(1:length(maha2), maha2)
abline(h=qchisq(0.05, 2, lower.tail = F), lty=2)
out <- maha2[maha2>qchisq(0.05, 2, lower.tail = F)]
text(order(maha2[maha2>qchisq(0.05, 2, lower.tail = F)]), out, names(out))
order(maha2[maha2>qchisq(0.05, 2, lower.tail = F)])
maha2
text(rank(maha2[maha2>qchisq(0.05, 2, lower.tail = F)]), out, names(out))
plot(1:length(maha2), maha2)
abline(h=qchisq(0.05, 2, lower.tail = F), lty=2)
out <- maha2[maha2>qchisq(0.05, 2, lower.tail = F)]
text(rank(maha2[maha2>qchisq(0.05, 2, lower.tail = F)]), out, names(out))
length(maha2)
plot(1:length(maha2), maha2)
abline(h=qchisq(0.05, 2, lower.tail = F), lty=2)
out <- maha2[maha2>qchisq(0.05, 2, lower.tail = F)]
text(c(42,46,47), out, names(out))
text(c(42,46,47)-1.5, out, names(out))
plot(1:length(maha2), maha2)
abline(h=qchisq(0.05, 2, lower.tail = F), lty=2)
out <- maha2[maha2>qchisq(0.05, 2, lower.tail = F)]
text(c(42,46,47)-1.5, out, names(out))
plot(1:length(maha2), maha2)
abline(h=qchisq(0.05, 2, lower.tail = F), lty=2)
out <- maha2[maha2>qchisq(0.05, 2, lower.tail = F)]
text(c(42,46,47)-5, out, names(out))
plot(1:length(maha2), maha2)
abline(h=qchisq(0.05, 2, lower.tail = F), lty=2)
out <- maha2[maha2>qchisq(0.05, 2, lower.tail = F)]
text(c(42,46,47)-7, out, names(out))
boxplot(swiss[,3])
par(mfrow=c(1,2))
boxplot(swiss[,3])
boxplot(swiss[,3])
#install_github("melina-leite/rmdformats")
library(knitr)
library(skimr)
library(ggplot2)
library(tidyverse)
opts_chunk$set(
fig.align = "center", fig.show = "hold", fig.height = 4,
warning = F, message = F, error = F, cache = T
)
options(formatR.arrow = TRUE, width = 90)
swiss
ggplot(swiss) + geom_boxplot(aes(x=Examination))
ggplot(swiss, aes(Examination)) + geom_boxplot()
ggplot(swiss) + geom_boxplot( aes(Examination))
ggplot(swiss) + geom_boxplot( aes(y=Examination, x-"Examination"))
ggplot(swiss) + geom_boxplot( aes(y=Examination, x="Examination"))
library(ggplot2); library(cowplot)
ggplot(swiss) + geom_boxplot( aes(y=Examination, x="Examination"))
ggplot(swiss,  aes(y=Examination, x="Examination")) + geom_boxplot() + geom_dotplot()
ggplot(swiss, aes(y=Examination, x="Examination")) + geom_boxplot() + geom_dotplot(binaxis = "y", stackdir = "center", position = "dodge")
library(ggplot2); library(cowplot); library(patchwork)
swiss
ggplot(swiss, aes(y=Examination, x="Examination")) + geom_boxplot() + geom_dotplot(binaxis = "y", stackdir = "center", position = "dodge") +
ggplot(swiss, aes(y=Education, x="Education")) + geom_boxplot() + geom_dotplot(binaxis = "y", stackdir = "center", position = "dodge") +
plot_layout(ncol=2)
ggplot(swiss, aes(y=Examination, x="Examination")) + geom_boxplot() + geom_dotplot(binaxis = "y", stackdir = "center", position = "dodge") +
ggplot(swiss, aes(y=Education, x="Education")) + geom_boxplot() + geom_dotplot(binaxis = "y", stackdir = "center", position = "dodge", shape=21) +
plot_layout(ncol=2)
ggplot(swiss, aes(y=Examination, x="Examination")) + geom_boxplot() + geom_dotplot(binaxis = "y", stackdir = "center", position = "dodge") +
ggplot(swiss, aes(y=Education, x="Education")) + geom_boxplot() + geom_dotplot(binaxis = "y", stackdir = "center", position = "dodge", shape=16) +
plot_layout(ncol=2)
ggplot(swiss, aes(y=Examination, x="Examination")) + geom_boxplot() + geom_dotplot(binaxis = "y", stackdir = "center", position = "dodge") +
ggplot(swiss, aes(y=Education, x="Education")) + geom_boxplot() + geom_dotplot(binaxis = "y", stackdir = "center", position = "dodge",shape=1) +
plot_layout(ncol=2)
ggplot(swiss, aes(y=Examination, x="Examination")) + geom_boxplot() + geom_dotplot(binaxis = "y", stackdir = "center", position = "dodge") +
ggplot(swiss, aes(y=Education, x="Education")) + geom_boxplot() + geom_dotplot(binaxis = "y", stackdir = "center", position = "dodge",fill="white") +
plot_layout(ncol=2)
ggplot(swiss, aes(y=Examination, x="Examination")) +
geom_dotplot(binaxis = "y", stackdir = "center", position = "dodge", fill="white") +
geom_boxplot() +
ggplot(swiss, aes(y=Education, x="Education")) + geom_dotplot(binaxis = "y", stackdir = "center", position = "dodge",fill="white") + geom_boxplot() +
plot_layout(ncol=2)
ggplot(swiss, aes(y=Examination, x="Examination")) + geom_boxplot() + geom_dotplot(binaxis = "y", stackdir = "center", position = "dodge", fill="white") +
ggplot(swiss, aes(y=Education, x="Education")) + geom_boxplot() + geom_dotplot(binaxis = "y", stackdir = "center", position = "dodge",fill="white") +
plot_layout(ncol=2)
ggplot(swiss, aes(y=Examination, x="Examination")) + geom_boxplot() + geom_dotplot(binaxis = "y", stackdir = "center", position = "dodge", fill="white", dotsize=0.8) +
ggplot(swiss, aes(y=Education, x="Education")) + geom_boxplot() + geom_dotplot(binaxis = "y", stackdir = "center", position = "dodge",fill="white") +
plot_layout(ncol=2)
#usando pacotes para plot:
library(ggplot2); library(cowplot); library(patchwork)
ggplot(swiss, aes(y=Examination, x="Examination")) +
geom_boxplot() +
geom_dotplot(binaxis = "y", stackdir = "center", position = "dodge", fill="white", dotsize=0.8) +
ggplot(swiss, aes(y=Education, x="Education")) +
geom_boxplot() +
geom_dotplot(binaxis = "y", stackdir = "center", position = "dodge",fill="white", dotsize=0.8) +
plot_layout(ncol=2)
ggplot(swiss, aes(y=Education, x="Education")) +
geom_boxplot() +
# geom_dotplot(binaxis = "y", stackdir = "center", position = "dodge",fill="white", dotsize=0.8) +
plot_layout(ncol=2)
ggplot(swiss, aes(y=Education, x="Education")) +
geom_boxplot()
#usando pacotes para plot:
library(ggplot2); library(cowplot); library(patchwork)
ggplot(swiss, aes(y=Examination, x="Examination")) +
geom_boxplot() +
geom_dotplot(binaxis = "y", stackdir = "center", position = "dodge", fill="white", dotsize=0.8) +
ggplot(swiss, aes(y=Education, x="Education")) +
geom_boxplot() +
geom_dotplot(binaxis = "y", stackdir = "center", position = "dodge",fill="white", dotsize=0.8) +
plot_layout(ncol=2)
library(MVA)
bvbox(swiss[,c(3,4)], xlab = colnames(swiss)[3], ylab = colnames(swiss)[4], pch="")
bvbox(swiss[,c(3,4)], xlab = colnames(swiss)[3], ylab = colnames(swiss)[4])
#usando pacotes para plot:
library(ggplot2); library(cowplot); library(patchwork)
ggplot(swiss, aes(y=Examination, x="Examination")) +
geom_boxplot() +
geom_dotplot(binaxis = "y", stackdir = "center", position = "dodge", fill="white", dotsize=0.8) +
ggplot(swiss, aes(y=Education, x="Education")) +
geom_boxplot() +
geom_dotplot(binaxis = "y", stackdir = "center", position = "dodge",fill="white", dotsize=0.8) +
plot_layout(ncol=2)
out <- function(x) {
return(x < quantile(x, 0.25) - 1.5 * IQR(x) | x > quantile(x, 0.75) + 1.5 * IQR(x))
}
swiss$out <- mutate(swiss, outlier = ifelse(is_outlier(swiss[,3:4]), swiss[,3:4], as.numeric(NA)))
swiss$out <- mutate(swiss, outlier = ifelse(out(swiss[,3:4]), swiss[,3:4], as.numeric(NA)))
swiss %>% mutate( outlier = ifelse(out(swiss[,3:4]), swiss[,3:4], as.numeric(NA)))
out(swiss[,4])
rownames(swiss[out(swiss[,4]),])
swiss[out(swiss[,4]),4]
ggplot(swiss, aes(y=Education, x="Education")) +
geom_boxplot() +
geom_dotplot(binaxis = "y", stackdir = "center", position = "dodge",fill="white", dotsize=0.8) +
annotate("text", x=1, y=swiss[out(swiss[,4]),4], label= rownames(swiss[out(swiss[,4]),]))
ggplot(swiss, aes(y=Education, x="Education")) +
geom_boxplot() +
geom_dotplot(binaxis = "y", stackdir = "center", position = "dodge",fill="white", dotsize=0.8) +
annotate("text", x=1.2, y=swiss[out(swiss[,4]),4], label= rownames(swiss[out(swiss[,4]),]))
ggplot(swiss, aes(y=Examination, x="Examination")) +
geom_boxplot() +
geom_dotplot(binaxis = "y", stackdir = "center", position = "dodge", fill="white", dotsize=0.8) +
ggplot(swiss, aes(y=Education, x="Education")) +
geom_boxplot() +
geom_dotplot(binaxis = "y", stackdir = "center", position = "dodge",fill="white", dotsize=0.8) +
annotate("text", x=c(1.1,1.1,0.7,1.1,0.2), y=swiss[out(swiss[,4]),4], label= rownames(swiss[out(swiss[,4]),]))
ggplot(swiss, aes(y=Education, x="Education")) +
geom_boxplot() +
geom_dotplot(binaxis = "y", stackdir = "center", position = "dodge",fill="white", dotsize=0.8) +
annotate("text", x=c(1.1,1.1,0.7,1.1,0.2), y=swiss[out(swiss[,4]),4], label= rownames(swiss[out(swiss[,4]),]))
ggplot(swiss, aes(y=Education, x="Education")) +
geom_boxplot() +
geom_dotplot(binaxis = "y", stackdir = "center", position = "dodge",fill="white", dotsize=0.8) +
annotate("text", x=c(1.1,1.1,0.7,1.1,0.6), y=swiss[out(swiss[,4]),4], label= rownames(swiss[out(swiss[,4]),]))
ggplot(swiss, aes(y=Education, x="Education")) +
geom_boxplot() +
geom_dotplot(binaxis = "y", stackdir = "center", position = "dodge",fill="white", dotsize=0.8) +
annotate("text", x=c(1.1,1.1,0.8,1.1,1.1), y=swiss[out(swiss[,4]),4], label= rownames(swiss[out(swiss[,4]),]))
ggplot(swiss, aes(y=Education, x="Education")) +
geom_boxplot() +
geom_dotplot(binaxis = "y", stackdir = "center", position = "dodge",fill="white", dotsize=0.8) +
annotate("text", x=c(1.1,1.1,0.8,1.1,0.7), y=swiss[out(swiss[,4]),4], label= rownames(swiss[out(swiss[,4]),]))
ggplot(swiss, aes(y=Education, x="Education")) +
geom_boxplot() +
geom_dotplot(binaxis = "y", stackdir = "center", position = "dodge",fill="white", dotsize=0.8) +
annotate("text", x=c(1.1,1.1,1.1,1.1,0.9), y=swiss[out(swiss[,4]),4], label= rownames(swiss[out(swiss[,4]),]))
ggplot(swiss, aes(y=Examination, x="Examination")) +
geom_boxplot() +
geom_dotplot(binaxis = "y", stackdir = "center", position = "dodge",
fill="white", dotsize=0.8) +
ggplot(swiss, aes(y=Education, x="Education")) +
geom_boxplot() +
geom_dotplot(binaxis = "y", stackdir = "center", position = "dodge",
fill="white", dotsize=0.8) +
annotate("text", x=c(1.1,1.1,1.1,1.1,0.9),
y=swiss[out(swiss[,4]),4],
label= rownames(swiss[out(swiss[,4]),])) +
plot_layout(ncol=2)
ggplot(swiss, aes(y=Examination, x="Examination")) +
geom_boxplot() +
geom_dotplot(binaxis = "y", stackdir = "center", position = "dodge",
fill="white", dotsize=0.8) +
ggplot(swiss, aes(y=Education, x="Education")) +
geom_boxplot() +
geom_dotplot(binaxis = "y", stackdir = "center", position = "dodge",
fill="white", dotsize=0.8) +
annotate("text", x=c(1.2,1.2,1.2,1.2,0.8),
y=swiss[out(swiss[,4]),4],
label= rownames(swiss[out(swiss[,4]),])) +
plot_layout(ncol=2)
library(MVA)
bvbox(swiss[,c(3,4)], xlab = colnames(swiss)[3], ylab = colnames(swiss)[4])
text(swiss[out(swiss[,4]),3], swiss[out(swiss[,4]),4], rownames(swiss[out(swiss[,4]),4]))
swiss[out(swiss[,4]),3]
swiss[out(swiss[,4]),4]
bvbox(swiss[,c(3,4)], xlab = colnames(swiss)[3], ylab = colnames(swiss)[4])
rownames(swiss[out(swiss[,4]),4])
out(swiss[,4]),4]
out(swiss[,4]),4])
library(MVA)
bvbox(swiss[,c(3,4)], xlab = colnames(swiss)[3], ylab = colnames(swiss)[4])
text(swiss[out(swiss[,4]),3], swiss[out(swiss[,4]),4], rownames(swiss[out(swiss[,4]),]))
library(MVA)
bvbox(swiss[,c(3,4)], xlab = colnames(swiss)[3], ylab = colnames(swiss)[4])
text(x=swiss[out(swiss[,4]),3], y=swiss[out(swiss[,4]),4]-1, rownames(swiss[out(swiss[,4]),]))
library(MVA)
bvbox(swiss[,c(3,4)], xlab = colnames(swiss)[3], ylab = colnames(swiss)[4])
text(x=swiss[out(swiss[,4]),3], y=swiss[out(swiss[,4]),4]-2, rownames(swiss[out(swiss[,4]),]))
library(MVA)
bvbox(swiss[,c(3,4)], xlab = colnames(swiss)[3], ylab = colnames(swiss)[4])
text(x=swiss[out(swiss[,4]),3], y=swiss[out(swiss[,4]),4]-2.5, rownames(swiss[out(swiss[,4]),]))
maha <- mahalanobis(swiss[,3:4], center = colMeans(swiss[,3:4]), cov = cov(swiss[,3:4]))
maha
# é preciso explicitar o centro da distribuição e a matriz de covariância:
maha <- mahalanobis(swiss[,3:4], center = colMeans(swiss[,3:4]), cov = cov(swiss[,3:4]))
plot(1:length(maha2), maha2)
abline(h=qchisq(0.05, 2, lower.tail = F), lty=2)
out <- maha2[maha2>qchisq(0.05, 2, lower.tail = F)]
text(c(42,46,47)-7, out, names(out))
